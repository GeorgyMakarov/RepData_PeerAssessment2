subset_data3$event[grep("frost", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("freeze", subset_data3$event_type)] <- "cold"
length(unique(subset_data3$event))
subset_data3$event[grep("tornado", subset_data3$event_type)] <- "tornado"
subset_data3$event[grep("hail", subset_data3$event_type)] <- "hail"
subset_data3$event[grep("winds", subset_data3$event_type)] <- "wind"
subset_data3$event[grep("win", subset_data3$event_type)] <- "wind"
subset_data3$event[grep("wins", subset_data3$event_type)] <- "wind"
length(unique(subset_data3$event))
unique(subset_data3$event)
subset_data3$event[grep("storm", subset_data3$event_type)] <- "storm"
length(unique(subset_data3$event))
subset_data3$event[grep("rainstorm", subset_data3$event_type)] <- "storm"
subset_data3$event[grep("thunderstorm", subset_data3$event_type)] <- "storm"
length(unique(subset_data3$event))
subset_data3$event[grep("snow", subset_data3$event_type)] <- "snow"
subset_data3$event[grep("rain", subset_data3$event_type)] <- "rain"
subset_data3$event[grep("heat", subset_data3$event_type)] <- "heat"
length(unique(subset_data3$event))
unique(subset_data3$event)
subset_data3$event[grep("hurricane", subset_data3$event_type)] <- "hurricane"
length(unique(subset_data3$event))
unique(subset_data3$event)
sort(table(subset_data3$event), decreasing = TRUE)[1:10]
sort(table(subset_data3$event), decreasing = TRUE)[11:21]
subset_data3$event[grep("blizzard", subset_data3$event_type)] <- "snow"
length(unique(subset_data3$event))
unique(subset_data3$event)
sort(table(subset_data3$event), decreasing = TRUE)[1:10]
sort(table(subset_data3$event), decreasing = TRUE)[11:21]
subset_data3$event[grep("fld", subset_data3$event_type)] <- "flood"
subset_data3$event[grep("current", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("surf", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("fire", subset_data3$event_type)] <- "fire"
length(unique(subset_data3$event))
unique(subset_data3$event)
subset_data3$event[grep("water", subset_data3$event_type)] <- "flood"
subset_data3$event[grep("wave", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("tsunami", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("lightning", subset_data3$event_type)] <- "storm"
subset_data3$event[grep("warm", subset_data3$event_type)] <- "heat"
subset_data3$event[grep("torndao", subset_data3$event_type)] <- "tornado"
length(unique(subset_data3$event))
unique(subset_data3$event)
sort(table(subset_data3$event), decreasing = TRUE)[11:21]
sort(table(subset_data3$event), decreasing = TRUE)[1:10]
subset_data3$event[grep("high tides", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("high seas", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("marine mishap", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("slide", subset_data3$event_type)] <- "slides"
length(unique(subset_data3$event))
unique(subset_data3$event)
sort(table(subset_data3$event), decreasing = TRUE)[1:10]
sort(table(subset_data3$event), decreasing = TRUE)[11:21]
sort(table(subset_data3$event), decreasing = TRUE)[11:20]
subset_data3$event[grep("dust devil", subset_data3$event_type)] <- "heat"
subset_data3$event[grep("dry microburst", subset_data3$event_type)] <- "heat"
subset_data3$event[grep("low temperature", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("freezing spray", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("dam break", subset_data3$event_type)] <- "flood"
length(unique(subset_data3$event))
unique(subset_data3$event)
sort(table(subset_data3$event), decreasing = TRUE)[1:10]
sum(sort(table(subset_data3$event), decreasing = TRUE)[1:10])
subset_data3$event <- "other"
subset_data3$event[grep("avalanche", subset_data3$event_type)] <- "avalanche"
subset_data3$event[grep("blizzard", subset_data3$event_type)] <- "snow"
subset_data3$event[grep("flood", subset_data3$event_type)] <- "flood"
subset_data3$event[grep("wind", subset_data3$event_type)] <- "wind"
subset_data3$event[grep("fog", subset_data3$event_type)] <- "fog"
subset_data3$event[grep("cold", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("chill", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("frost", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("freeze", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("tornado", subset_data3$event_type)] <- "tornado"
subset_data3$event[grep("hail", subset_data3$event_type)] <- "hail"
subset_data3$event[grep("winds", subset_data3$event_type)] <- "wind"
subset_data3$event[grep("win", subset_data3$event_type)] <- "wind"
subset_data3$event[grep("wins", subset_data3$event_type)] <- "wind"
subset_data3$event[grep("storm", subset_data3$event_type)] <- "storm"
subset_data3$event[grep("rainstorm", subset_data3$event_type)] <- "storm"
subset_data3$event[grep("thunderstorm", subset_data3$event_type)] <- "storm"
subset_data3$event[grep("snow", subset_data3$event_type)] <- "snow"
subset_data3$event[grep("rain", subset_data3$event_type)] <- "rain"
subset_data3$event[grep("heat", subset_data3$event_type)] <- "heat"
subset_data3$event[grep("hurricane", subset_data3$event_type)] <- "hurricane"
subset_data3$event[grep("fld", subset_data3$event_type)] <- "flood"
subset_data3$event[grep("current", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("surf", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("fire", subset_data3$event_type)] <- "fire"
subset_data3$event[grep("water", subset_data3$event_type)] <- "flood"
subset_data3$event[grep("wave", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("tsunami", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("lightning", subset_data3$event_type)] <- "storm"
subset_data3$event[grep("warm", subset_data3$event_type)] <- "heat"
subset_data3$event[grep("torndao", subset_data3$event_type)] <- "tornado"
subset_data3$event[grep("high tides", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("high seas", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("marine mishap", subset_data3$event_type)] <- "waves"
subset_data3$event[grep("slide", subset_data3$event_type)] <- "slides"
subset_data3$event[grep("dust devil", subset_data3$event_type)] <- "heat"
subset_data3$event[grep("dry microburst", subset_data3$event_type)] <- "heat"
subset_data3$event[grep("low temperature", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("freezing spray", subset_data3$event_type)] <- "cold"
subset_data3$event[grep("dam break", subset_data3$event_type)] <- "flood"
length(unique(subset_data3$event))
sum(sort(table(subset_data3$event), decreasing = TRUE)[1:10])
sort(table(subset_data3$event), decreasing = TRUE)[1:10]
sort(table(subset_data3$event), decreasing = TRUE)[11:20]
sort(table(subset_data3$event), decreasing = TRUE)[11:16]
nrow(subset_data3)
sum(sort(table(subset_data3$event), decreasing = TRUE)[1:10]) / nrow(subset_data3)
sum(sort(table(subset_data3$event), decreasing = TRUE)[1:10])
sort(table(subset_data3$event), decreasing = TRUE)[1:10]
subset_data4 <- subset_data3 %>%
filter(event %in% c("wind", "storm", "tornado", "flood", "hail", "snow",
"fire", "rain", "heat", "waves"))
dim(subset_data4)
unique(subset_data4$property_multiplier)
unique(subset_data4$crop_multiplier)
subset_data4 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
unique(subset_data4$property_multiplier)
unique(subset_data4$crop_multiplier)
subset_data4$property_multiplier[is.na(subset_data4$property_multiplier)] <- 0
subset_data4$crop_multiplier[is.na(subset_data4$crop_multiplier)] <- 0
unique(subset_data4$property_multiplier)
unique(subset_data4$crop_multiplier)
subset_data4$property_multiplier[grep("k", subset_data4$property_multiplier)] <- "3"
subset_data4$property_multiplier[grep("m", subset_data4$property_multiplier)] <- "6"
subset_data4$property_multiplier[grep("b", subset_data4$property_multiplier)] <- "9"
unique(subset_data4$property_multiplier)
subset_data4$property_multiplier[grep("", subset_data4$property_multiplier)] <- "1"
unique(subset_data4$property_multiplier)
subset_data4 <- subset_data3 %>%
filter(event %in% c("wind", "storm", "tornado", "flood", "hail", "snow",
"fire", "rain", "heat", "waves"))
dim(subset_data4)
unique(subset_data4$property_multiplier)
unique(subset_data4$crop_multiplier)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
unique(subset_data4$property_multiplier)
unique(subset_data5$property_multiplier)
subset_data5$property_multiplier[grep("+", subset_data5$property_multiplier)] <- "1"
unique(subset_data5$property_multiplier)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
unique(subset_data5$property_multiplier)
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
unique(subset_data5$property_multiplier)
subset_data5$property_multiplier[grep("+ | -", subset_data5$property_multiplier, ignore.case = TRUE)] <- "0"
unique(subset_data5$property_multiplier)
subset_data5$property_multiplier[grep("+|-", subset_data5$property_multiplier, ignore.case = TRUE)] <- "0"
unique(subset_data5$property_multiplier)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
unique(subset_data5$property_multiplier)
num_char <- c("0", "2", "3", "4", "5", "6", "7", "8", "9")
subset_data5$property_multiplier[!grepl(num_char, subset_data5$property_multiplier, ignore.case = TRUE)] <- "0"
subset_data5$property_multiplier[!grepl("0|2|3|4|5|6|7|8|9", subset_data5$property_multiplier, ignore.case = TRUE)] <- "0"
unique(subset_data5$property_multiplier)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
unique(subset_data5$property_multiplier)
subset_data5 <- subset_data5 %>%
mutate(property_multiplier = as.numeric(recode("" = 0, "+" = 0, "-" = 0)))
subset_data5 <- subset_data5 %>%
mutate(property_multiplier = as.numeric(recode(" " = 0, "+" = 0, "-" = 0)))
unique(subset_data5$property_multiplier)
unique(subset_data4$property_multiplier)
subset_data5 <- subset_data5 %>%
mutate(property_multiplier = as.numeric(recode(" " = 0, "+" = 0, "-" = 0,
"1" = 1, "2" = 2, "3" = 3,
"4" = 4, "5" = 5, "6" = 6,
"7" = 7, "8" = 8, "9" = 9)))
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier <- as.character(subset_data5$property_multiplier)
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
unique(subset_data5$property_multiplier)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier <- as.character(subset_data5$property_multiplier)
unique(subset_data5$property_multiplier)
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
unique(subset_data5$property_multiplier)
subset_data5$property_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$property_multiplier)] <- 0
unique(subset_data5$property_multiplier)
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
unique(subset_data5$property_multiplier)
subset_data5$crop_multiplier <- as.character(subset_data5$crop_multiplier)
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[grep("k", subset_data5$crop_multiplier)] <- "3"
subset_data5$crop_multiplier[grep("m", subset_data5$crop_multiplier)] <- "6"
subset_data5$crop_multiplier[grep("b", subset_data5$crop_multiplier)] <- "9"
subset_data5$crop_multiplier[grep("h", subset_data5$crop_multiplier)] <- "2"
unique(subset_data4$crop_multiplier)
unique(subset_data5$crop_multiplier)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$crop_multiplier <- as.character(subset_data5$crop_multiplier)
unique(subset_data5$crop_multiplier)
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$property_multiplier <- as.character(subset_data5$property_multiplier)
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
subset_data5$crop_multiplier <- as.character(subset_data5$crop_multiplier)
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[grep("k", subset_data5$crop_multiplier)] <- "3"
subset_data5$crop_multiplier[grep("m", subset_data5$crop_multiplier)] <- "6"
subset_data5$crop_multiplier[grep("b", subset_data5$crop_multiplier)] <- "9"
subset_data5$crop_multiplier[grep("h", subset_data5$crop_multiplier)] <- "2"
unique(subset_data5$property_multiplier)
unique(subset_data5$crop_multiplier)
subset_data5$property_multiplier <- as.numeric(as.character(subset_data5$property_multiplier))
subset_data5$crop_multiplier <- as.numeric(as.character(subset_data5$crop_multiplier))
unique(subset_data5$property_multiplier)
unique(subset_data5$crop_multiplier)
subset_data5 <- subset_data5 %>%
mutate(prop_damage = property_damage * 10^property_multiplier,
crop_damage = crop_damage * 10^crop_multiplier)
head(subset_data5)
subset_data5 <- subset_data5 %>%
mutate(prop_damage = property_damage * 10^property_multiplier,
crop_damage = crop_damage * 10^crop_multiplier) %>%
select(event, fatalities, injuries, crop_damage, prop_damage)
head(subset_data5)
sum(subset_data5$crop_damage)
health_dt <- subset_data5 %>%
mutate(health_impact = fatalities + injuries) %>%
group_by(event) %>% summarise(health_impact = sum(health_impact))
health_dt
health_dt <- subset_data5 %>%
group_by(event) %>% summarise(fatalities = sum(fatalities),
injuries = sum(injuries))
health_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage = sum(crop_damage),
prop_damage = sum(prop_damage))
economic_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage_mln = sum(crop_damage) / 1000000,
prop_damage_mln = sum(prop_damage) / 1000000)
economic_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage_bln = sum(crop_damage) / 1000000000,
prop_damage_bln = sum(prop_damage) / 1000000000)
economic_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage_bln = sum(crop_damage) / 1000000,
prop_damage_bln = sum(prop_damage) / 1000000000)
economic_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage_bln = sum(crop_damage) / 1000000000,
prop_damage_bln = sum(prop_damage) / 1000000000)
economic_dt
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier <- as.character(subset_data5$property_multiplier)
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
subset_data5$property_multiplier <- as.numeric(as.character(subset_data5$property_multiplier))
unique(subset_data5$property_multiplier)
head(subset_data5)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier <- as.character(subset_data5$property_multiplier)
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
subset_data5$crop_multiplier <- as.character(subset_data5$crop_multiplier)
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[grep("k", subset_data5$crop_multiplier)] <- "3"
subset_data5$crop_multiplier[grep("m", subset_data5$crop_multiplier)] <- "6"
subset_data5$crop_multiplier[grep("b", subset_data5$crop_multiplier)] <- "9"
subset_data5$crop_multiplier[grep("h", subset_data5$crop_multiplier)] <- "2"
subset_data5$property_multiplier <- as.numeric(as.character(subset_data5$property_multiplier))
subset_data5$crop_multiplier <- as.numeric(as.character(subset_data5$crop_multiplier))
filter(subset_data5$crop_damage > 0)
subset_data5 <- subset_data4 %>%
mutate(property_multiplier = tolower(property_multiplier),
crop_multiplier = tolower(crop_multiplier))
subset_data5$property_multiplier <- as.character(subset_data5$property_multiplier)
subset_data5$property_multiplier[is.na(subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$property_multiplier)] <- 0
subset_data5$property_multiplier[grep("k", subset_data5$property_multiplier)] <- "3"
subset_data5$property_multiplier[grep("m", subset_data5$property_multiplier)] <- "6"
subset_data5$property_multiplier[grep("b", subset_data5$property_multiplier)] <- "9"
subset_data5$property_multiplier[grep("h", subset_data5$property_multiplier)] <- "2"
subset_data5$crop_multiplier <- as.character(subset_data5$crop_multiplier)
subset_data5$crop_multiplier[is.na(subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[!grepl("k|m|b|h|2|3|4|5|6|7", subset_data5$crop_multiplier)] <- 0
subset_data5$crop_multiplier[grep("k", subset_data5$crop_multiplier)] <- "3"
subset_data5$crop_multiplier[grep("m", subset_data5$crop_multiplier)] <- "6"
subset_data5$crop_multiplier[grep("b", subset_data5$crop_multiplier)] <- "9"
subset_data5$crop_multiplier[grep("h", subset_data5$crop_multiplier)] <- "2"
subset_data5$property_multiplier <- as.numeric(as.character(subset_data5$property_multiplier))
subset_data5$crop_multiplier <- as.numeric(as.character(subset_data5$crop_multiplier))
help1 <- subset_data5 %>%
filter(crop_damage > 0)
help1
help1 <- subset_data5 %>%
filter(crop_damage > 0) %>% select(event, crop_damage, crop_multiplier)
help1
help1 <- subset_data5 %>%
filter(crop_damage > 0) %>% select(event, crop_damage, crop_multiplier) %>%
filter(crop_multiplier == 9)
help1
subset_data5 <- subset_data5 %>%
mutate(prop_damage = property_damage * 10^property_multiplier,
crop_damage = crop_damage * 10^crop_multiplier) %>%
select(event, fatalities, injuries, crop_damage, prop_damage)
head(subset_data5)
health_dt <- subset_data5 %>%
group_by(event) %>% summarise(fatalities = sum(fatalities),
injuries = sum(injuries))
health_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(prop_damage_bln = sum(prop_damage) / 1000000000)
economic_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage = sum(crop_damage),
prop_damage_bln = sum(prop_damage) / 1000000000)
economic_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage = sum(crop_damage) / 1000000000,
prop_damage_bln = sum(prop_damage) / 1000000000)
economic_dt
economic_dt <- subset_data5 %>%
group_by(event) %>% summarise(crop_damage_bln = sum(crop_damage) / 1000000000,
prop_damage_bln = sum(prop_damage) / 1000000000)
economic_dt
ggplot(health_dt) +
geom_col(aes(event, fatalities + injuries))
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, fatalities + injuries))
health_dt
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, fatalities + injuries), stat = "identity")
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, fatalities + injuries))
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_boxplot(aes(event, fatalities + injuries))
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, fatalities + injuries))
ggplot(subset_data5) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, fatalities + injuries))
ggplot(subset_data5) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_boxplot(aes(event, fatalities + injuries))
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, fatalities + injuries))
fatal_h <- health_dt %>%
select(event, fatalities)
injuries_h <- health_dt %>%
select(event, injuries)
health_dt <- rbind(fatal_h, injuries_h)
fatal_h
?rbind
injuries_h <- health_dt %>%
select(event, injuries) %>%
mutate(result = injuries, type = "injury")
injuries_h
injuries_h <- health_dt %>%
select(event, result = injuries) %>%
mutate(type = "injury")
injuries_h
fatal_h <- health_dt %>%
select(event, result = fatalities) %>%
mutate(type = "fatal")
fatal_h
health_dt <- rbind(fatal_h, injuries_h)
health_dt
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, result, color = type))
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, result, fill = type))
prop_econ <- economic_dt %>%
select(event, result = prop_damage_bln) %>%
mutate(type = "property damage")
crop_econ <- economic_dt %>%
select(event, result = crop_damage_bln) %>%
mutate(type = "crop damage")
economic_dt <- rbind(prop_econ, crop_econ)
economic_dt
health_dt <- health_dt %>%
group_by(event) %>% summarise(result = sum(result)) %>%
arrange(desc(result))
health_dt
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, result, fill = type))
health_dt <- subset_data5 %>%
group_by(event) %>% summarise(fatalities = sum(fatalities),
injuries = sum(injuries))
fatal_h <- health_dt %>%
select(event, result = fatalities) %>%
mutate(type = "fatal")
injuries_h <- health_dt %>%
select(event, result = injuries) %>%
mutate(type = "injury")
health_dt <- rbind(fatal_h, injuries_h)
health_dt
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(event, result, fill = type))
ggplot(health_dt) +
theme_bw() +
ggtitle("Weather impact on population health") +
xlab("Event type") + ylab("Fatalities and Injuries") +
geom_col(aes(reorder(event, result), result, fill = type))
economic_dts <- economic_dt %>%
group_by(event) %>% summarise(result = sum(result)) %>%
arrange(desc(result))
economic_dts
ggplot(economic_dt) +
theme_bw() +
ggtitle("Weather impact on economy") +
xlab("Event type") + ylab("Loss in bln USD") +
geom_col(aes(reorder(event, result), result, fill = type))
